#include<iostream>
#include<limits>
#include<cmath>
using namespace std;

#define ROW 100
#define COL 100

void input_arr(int mt[][COL], int &m, int &n);
void output_arr(int mt[][COL], int m, int n);
int tongDong(int mt[][COL], int n, int d);
int tongCot(int mt[][COL], int m, int c);
int tongmt(int mt[][COL], int m, int n);
int check(float &n);

int main()
{
	int mt[ROW][COL];
	float a,b;
	cout<<"\nNhap so dong: ";  cin>>a;   check(a);
	cout<<"\nNhap so cot: ";   cin>>b;   check(b);
	int nROW = (int)a;
	int nCOL = (int)b;
	input_arr(mt,nROW,nCOL);
	output_arr(mt,nROW,nCOL);
	float d,c; // dong , cot
	
	cout<<"\nNhap dong can tinh tong: "; cin>>d;  
	while(!d || pow(d,2) != pow(d,2) || d < 0 || d > nROW)
	{
		if(!d)
		{
			cout<<"\nBan nhap khong dung dinh mang,moi nhap lai: ";
			cin>>d;
		}
		if(pow(d,2) != pow(d,2))
		{
			cout<<"\nSo nhap vao yeu cau la 1 so nguyen , moi nhap lai: ";
			cin>>d;
		}
		if(d < 0 || d > nROW)
		{
			cout<<"\nSo nhap vao yeu cau la so nguyen duong lon hon 0 va "
		}
	}
	do{
		if(!d || pow(d,2) != pow(d,2) || d < 0 || d > nROW)
		{
			cin.clear();
			cin.ignore(numeric_limits<streamsize>::max(),'\n');
			cout<<"\nYeu cau nhap vao mot so nguyen duong lon hon 0, moi nhap lai: ";
			cin>>d;
		}
	}while(!d || pow(d,2) != pow(d,2) || d !=(int)d || d < 0 || d > nROW);
	cout<<"\nTong dong = "<<tongDong(mt,nCOL,d)<<endl;
	cout<<"\nNhap cot can tinh tong: ";  cin>>c;  
	cout<<"\nTong cot = "<<tongCot(mt,nROW,c)<<endl;
	cout<<"\nTong cac phan tu cua mang bang "<<tongmt(mt,nROW,nCOL)<<endl;
	return 0;
}
int check(float &n)
{
	do{
		if(!n || pow(n,2) != pow(n,2) || n !=(int)n || n < 0 || n>100)
		{
			cin.clear();
			cin.ignore(numeric_limits<streamsize>::max(),'\n');
			cout<<"\nSo nhap vao yeu cau la mot so nguyen duong lon hon 0, moi nhap lai: ";
			cin>>n;
		}
	}while(!n || pow(n,2) != pow(n,2) || n!=(int)n || n < 0 || n>100);
}

void input_arr(int mt[][COL], int &m, int &n)
{
	for(int i=0 ; i<m ; i++)
	{
		for(int j=0 ; j<n ; j++)
		{
			cout<<"a["<<i+1<<"]["<<j+1<<"]=";
			cin>>mt[i][j];
			do{
				if(cin.fail())
				{
					cin.clear();
					cin.ignore(numeric_limits<streamsize>::max(),'\n');
					cout<<"\nDu lieu nhap vao mang yeu cau la so nguyen, moi nhap lai: ";
				 	cin>>mt[i][j];
				}
			}while(cin.fail());
		}
	}
}
void output_arr(int mt[][COL], int m, int n)
{
	cout<<"\nMang vua nhap la: \n";
	for(int i=0 ; i<m ; i++)
	{
		for(int j=0 ; j<n ; j++)
		{
			cout<<mt[i][j]<<"\t";
		}
		cout<<endl;
	}
}

int tongDong(int mt[][COL], int n, int d)
{
	int sum(0);
	for(int j=0 ; j<n ; j++)
	{
		sum+=mt[d][j];
	}
	return sum;
}
int tongCot(int mt[][COL], int m, int c)
{
	int sum(0);
	for(int i=0 ; i<m ; i++)
	{
		sum+=mt[i][c];
	}
	return sum;
}

int tongmt(int mt[][COL], int m, int n)
{
	int sum = 0;
	cout << "Tong cac phan tu trong ma tran vua nhap bang ";	
	for(int i = 0; i < m; i++){
		for(int j = 0; j < n; j++){
			sum += mt[i][j];
			}
		}
	return sum;
}
